<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Zero Nav</title>
  <meta id="theme-color" name="theme-color" content="#0b0c0f" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: radial-gradient(1200px 800px at 10% 0%, #e8efff 0%, transparent 50%), radial-gradient(1000px 800px at 90% 0%, #fce7f3 0%, transparent 50%), #f7f7f8;
      --text:#0f172a; --muted:#6b7280; --border:#e5e7eb; --card:#ffffffb3; --accent:#6366f1; --accent-2:#22d3ee; --radius:16px; --shadow:0 2px 8px rgba(15,23,42,.06),0 12px 30px rgba(15,23,42,.08);
    }
    @media (prefers-color-scheme: dark){
      :root{ --bg: radial-gradient(1200px 800px at 10% 0%, #0b1220 0%, transparent 55%), radial-gradient(1000px 800px at 90% 0%, #1b1030 0%, transparent 55%), #0b0c0f; --text:#e5e7eb; --muted:#9aa3b2; --border:#1f2430; --card:#0f1117cc; --accent:#8b5cf6; --accent-2:#22d3ee; --shadow:0 2px 10px rgba(0,0,0,.35),0 14px 40px rgba(0,0,0,.45);}    }

    /* 手动主题覆盖（按钮切换时优先生效） */
    html[data-theme="light"]{ --bg: radial-gradient(1200px 800px at 10% 0%, #e8efff 0%, transparent 50%), radial-gradient(1000px 800px at 90% 0%, #fce7f3 0%, transparent 50%), #f7f7f8; --text:#0f172a; --muted:#6b7280; --border:#e5e7eb; --card:#ffffffb3; --accent:#6366f1; --accent-2:#22d3ee; --radius:16px; --shadow:0 2px 8px rgba(15,23,42,.06),0 12px 30px rgba(15,23,42,.08);} 
    html[data-theme="dark"]{ --bg: radial-gradient(1200px 800px at 10% 0%, #0b1220 0%, transparent 55%), radial-gradient(1000px 800px at 90% 0%, #1b1030 0%, transparent 55%), #0b0c0f; --text:#e5e7eb; --muted:#9aa3b2; --border:#1f2430; --card:#0f1117cc; --accent:#8b5cf6; --accent-2:#22d3ee; --shadow:0 2px 10px rgba(0,0,0,.35),0 14px 40px rgba(0,0,0,.45);} 

    html,body{margin:0;height:100%;overflow-x:hidden;}
    body{font:15px/1.65 Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans"; color:var(--text); background:var(--bg);}

    .container{max-width:1120px;margin:0 auto;padding:24px 16px 56px;}
    header.hero{padding-top:14px;margin-bottom:10px}
    .brand{display:flex;align-items:center;gap:10px}
    .logo{width:34px;height:34px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent-2)); box-shadow:0 8px 24px rgba(99,102,241,.35);}
    h2{font-size:28px;font-weight:700;letter-spacing:.2px;margin:0}
    .muted{color:var(--muted);font-size:13px;margin-top:6px}

    /* 搜索条 */
    .search{position:sticky;top:0;z-index:10;margin:16px 0 8px; padding:10px 16px; 
      /* 之前使用 #fff 造成深色模式下出现发白的整条背景，这里改为主题色并提供回退 */
      background: transparent;
      background: color-mix(in oklab, var(--card) 70%, transparent);
      backdrop-filter: blur(10px); border-bottom:1px solid var(--border);}    
    .searchbar{max-width:1120px;margin:0 auto;display:flex;align-items:center;gap:10px;border:1px solid var(--border); background:var(--card); border-radius:999px;padding:10px 14px; box-shadow:var(--shadow)}
    .searchbar svg{color:#94a3b8}
    .searchbar input{flex:1;border:0;outline:0;background:transparent;color:var(--text);font-size:14px}
    .toolbar-spacer{flex:1}
    .btn-link{padding:6px 10px;border-radius:999px;border:1px solid var(--border);background:var(--card);color:var(--text);box-shadow:var(--shadow);cursor:pointer;text-decoration:none;display:inline-flex;align-items:center;gap:6px}
    .btn-link:hover{border-color: color-mix(in oklab, var(--accent) 35%, var(--border));}

    main{max-width:1120px;margin:0 auto;padding:0 16px}
    .section-title{display:flex;align-items:center;gap:10px;margin:28px 0 14px;color:var(--muted);font-weight:700;letter-spacing:.3px;text-transform:uppercase;font-size:12px}
    .section-title::after{content:"";flex:1;height:1px;background:var(--border)}

    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:16px}

    .card{position:relative;display:block;padding:16px;border-radius:var(--radius);background:var(--card); border:1px solid var(--border); box-shadow:var(--shadow); transition:transform .14s ease, box-shadow .14s ease, border-color .14s ease, background .14s ease; text-decoration:none;color:inherit}
    .card:hover{transform:translateY(-3px); box-shadow:0 6px 24px rgba(15,23,42,.12); border-color: color-mix(in oklab, var(--accent) 30%, var(--border));}
    .row{display:flex;align-items:center;gap:10px}
    .favicon{width:20px;height:20px;border-radius:6px}
    .name{font-weight:600; white-space: pre-line}
    .desc{color:var(--muted);font-size:13px;margin-top:8px;min-height:36px; white-space: pre-line}
    .tags{margin-top:10px;display:flex;gap:6px;flex-wrap:wrap}
    .tag{font-size:11px;padding:3px 8px;border-radius:999px;background:color-mix(in oklab, var(--accent) 10%, transparent); color: color-mix(in oklab, var(--accent) 60%, #374151); border:1px solid var(--border)}

    /* 骨架屏 */
    .skeleton-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:16px}
    .skeleton-card{border-radius:var(--radius);padding:16px;border:1px solid var(--border);background:var(--card);overflow:hidden;position:relative}
    .sk-row{display:flex;align-items:center;gap:10px}
    .sk-ico{width:20px;height:20px;border-radius:6px;background:#e5e7eb}
    .sk-bar{height:10px;border-radius:6px;background:#e5e7eb}
    .sk-bar.w80{width:80%} .sk-bar.w60{width:60%} .sk-bar.w40{width:40%}
    @media (prefers-color-scheme: dark){ .sk-ico,.sk-bar{background:#1f2430} }
    .shimmer{position:absolute;inset:0;transform:translateX(-100%);background: linear-gradient(90deg, transparent, rgba(255,255,255,.25), transparent); animation: shimmer 1.2s infinite}
    @keyframes shimmer{100%{transform:translateX(100%)}}

    footer{max-width:1120px;margin:28px auto 36px;padding:0 16px;color:var(--muted);font-size:12px}

    /* 主题按钮样式 */
    .theme-btn{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;border:1px solid var(--border);background:var(--card);color:var(--text);box-shadow:var(--shadow);cursor:pointer}
    .theme-btn:hover{border-color: color-mix(in oklab, var(--accent) 35%, var(--border));}
    .theme-btn svg{display:block}
  </style>
</head>
<body>
  <div class="container">
    <header class="hero">
      <div class="brand">
        <div>
          <h2>Zero Nav</h2>
          <p class="muted">Zero的个人导航页</p>
        </div>
      </div>
    </header>
  </div>

  <div class="search">
    <div class="searchbar">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><circle cx="11" cy="11" r="7"/><path d="M20 20l-3.2-3.2"/></svg>
      <input id="q" type="search" placeholder="搜索名称、描述..." aria-label="搜索" />
      <span class="toolbar-spacer"></span>
      <a id="adminLink" class="btn-link" target="_blank" rel="noopener noreferrer" title="打开表格后台">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="16" rx="2"/><path d="M3 10h18M8 4v16"/></svg>
        后台
      </a>
      <button id="themeToggle" class="theme-btn" aria-label="切换主题" title="切换主题"></button>
    </div>
  </div>

  <main>
    <div id="app">
      <!-- 骨架屏：加载期间显示，数据就绪后会被 app.js 替换 -->
      <div class="skeleton-grid">
        <div class="skeleton-card"><div class="shimmer"></div><div class="sk-row"><div class="sk-ico"></div><div class="sk-bar w60"></div></div><div style="height:8px"></div><div class="sk-bar w80"></div><div style="height:6px"></div><div class="sk-bar w40"></div></div>
        <div class="skeleton-card"><div class="shimmer"></div><div class="sk-row"><div class="sk-ico"></div><div class="sk-bar w60"></div></div><div style="height:8px"></div><div class="sk-bar w80"></div><div style="height:6px"></div><div class="sk-bar w40"></div></div>
        <div class="skeleton-card"><div class="shimmer"></div><div class="sk-row"><div class="sk-ico"></div><div class="sk-bar w60"></div></div><div style="height:8px"></div><div class="sk-bar w80"></div><div style="height:6px"></div><div class="sk-bar w40"></div></div>
        <div class="skeleton-card"><div class="shimmer"></div><div class="sk-row"><div class="sk-ico"></div><div class="sk-bar w60"></div></div><div style="height:8px"></div><div class="sk-bar w80"></div><div style="height:6px"></div><div class="sk-bar w40"></div></div>
        <div class="skeleton-card"><div class="shimmer"></div><div class="sk-row"><div class="sk-ico"></div><div class="sk-bar w60"></div></div><div style="height:8px"></div><div class="sk-bar w80"></div><div style="height:6px"></div><div class="sk-bar w40"></div></div>
        <div class="skeleton-card"><div class="shimmer"></div><div class="sk-row"><div class="sk-ico"></div><div class="sk-bar w60"></div></div><div style="height:8px"></div><div class="sk-bar w80"></div><div style="height:6px"></div><div class="sk-bar w40"></div></div>
      </div>
    </div>
  </main>

  <footer>
    <span class="muted">© 2025 uuzero</span>
  </footer>

  <script>
    (function(){
      // 存储仅记录 'light' 或 'dark'，不存在即为 'auto'
      const THEME_KEY = 'theme-preference';
      const btn = document.getElementById('themeToggle');
      const meta = document.getElementById('theme-color');
      const mql = window.matchMedia('(prefers-color-scheme: dark)');

      const icons = {
        light: '<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><circle cx="12" cy="12" r="4"/><path d="M12 2v2M12 20v2M2 12h2M20 12h2M4.9 4.9l1.4 1.4M17.7 17.7l1.4 1.4M4.9 19.1l1.4-1.4M17.7 6.3l1.4-1.4"/></svg>',
        dark: '<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>'
      };

      function currentPref(){
        return localStorage.getItem(THEME_KEY) || 'auto';
      }
      function effectiveMode(mode){
        if (mode === 'auto') {
          return mql.matches ? 'dark' : 'light';
        }
        return mode;
      }
      function labelOf(mode){
        return mode === 'light' ? '浅色' : '深色';
      }
      function setThemeColor(mode){
        meta && (meta.content = mode==='dark' ? '#0b0c0f' : '#f7f7f8');
      }
      function applyTheme(mode){
        if(mode === 'auto'){
          document.documentElement.removeAttribute('data-theme');
          setThemeColor(effectiveMode('auto'));
        } else {
          document.documentElement.setAttribute('data-theme', mode);
          setThemeColor(mode);
        }
        const eff = effectiveMode(mode);
        btn.innerHTML = icons[eff];
        btn.title = `主题：${labelOf(eff)}（点击切换）`;
        btn.setAttribute('aria-label', btn.title);
      }

      let mode = currentPref();
      applyTheme(mode);

      // 按钮仅在浅色/深色之间切换；若当前为 auto，则切到“与系统相反”的主题
      btn.addEventListener('click', ()=>{
        const pref = currentPref();
        let target;
        if (pref === 'auto') {
          target = mql.matches ? 'light' : 'dark';
        } else if (pref === 'light') {
          target = 'dark';
        } else {
          target = 'light';
        }
        localStorage.setItem(THEME_KEY, target);
        mode = target;
        applyTheme(mode);
      });

      // 当为 auto 时，系统主题变化自动跟随
      mql.addEventListener?.('change', ()=>{
        if(currentPref()==='auto') applyTheme('auto');
      });
    })();

    // 设置后台按钮链接（等待 window.NAV_SHEET 可用后再设置）
    (function(){
      const link = document.getElementById('adminLink');
      function apply(){
        if(!link) return;
        const sheet = window.NAV_SHEET;
        if(sheet && sheet.id){
          link.href = `https://docs.google.com/spreadsheets/d/${sheet.id}/edit`;
          return;
        }
        if(sheet && sheet.json){
          link.href = sheet.json;
        }
      }
      if (document.readyState === 'complete') {
        apply();
      } else {
        window.addEventListener('load', apply);
      }
    })();
  </script>
  <script src="assets/app.js"></script>
</body>
</html>